---
title: "01_calculate_inundation_area"
author: "Rich Cottrell"
date: "29/09/2022"
output: pdf_document
---


```{r}
library(tidyverse)
library(here)
library(sf)

```


# Flood extent
```{r}

flood_extents_shp <- st_read(here("data/spatial/Flood__Awareness__Extents/Flood___Awareness___Extents.shp"))

# flood_simple <- rmapshaper::ms_simplify(input = as(flood_extents_shp, 'Spatial')) %>%
#   st_as_sf()


ggplot()+
  geom_sf(data = flood_simple, fill="lightblue", colour = "grey90", size = 0.01)+
  theme_bw()




```
# SA2 regions
```{r}

SA2_aus <- st_read(here("data/spatial/sa2_2016_aust_shape/SA2_2016_AUST.shp"))

SA2_bris <- SA2_aus %>% 
  filter(STE_NAME16 == "Queensland" & 
           GCC_NAME16 == "Greater Brisbane" &
           SA4_NAME16 %in%  c("Brisbane - East","Brisbane - North", "Brisbane - South", "Brisbane - West", "Brisbane Inner City") & 
           (! SA2_NAME16 %in% c("Redland Islands"))) %>% 
  st_transform(crs = st_crs(flood_extent_shp))

ggplot()+
  geom_sf(data= SA2_bris)

```


Overlay SA2 with flood extent
```{r}

SA2_aus <- st_read(here("data/spatial/sa2_2016_aust_shape/SA2_2016_AUST.shp"))

SA2_bris <- SA2_aus %>% 
  filter(STE_NAME16 == "Queensland" & 
           GCC_NAME16 == "Greater Brisbane" &
           SA4_NAME16 %in%  c("Brisbane - East","Brisbane - North", "Brisbane - South", "Brisbane - West", "Brisbane Inner City") & 
           (! SA2_NAME16 %in% c("Redland Islands"))) %>% 
  st_transform(crs = st_crs(flood_extents_shp))

ggplot()+
  geom_sf(data= SA2_bris)


```


```{r}

rgeos::gBuffer(SA2_bris, byid=TRUE, width=0)


st_intersection(SA2_bris |> select(SA2_NAME16), flood_extents_shp)

ggplot()+
  geom_sf(data = SA2_bris)
```

