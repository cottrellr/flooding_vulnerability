### ------------------------------------------------------------------------ ###
### --------------- CODE FOR CREATION OF VULNERABILITY INDEX --------------- ###
### ------------------------------------------------------------------------ ###



### Libraries: ------------------------------------------------------------- ###
### ------------------------------------------------------------------------ ###
library(sf)
library(tidyverse)
library(dplyr)
library(here)
library(data.table)





### SHAPEFILE LOADING: ----------------------------------------------------- ###
### ------------------------------------------------------------------------ ###
BRIS <- read_sf("../../data/spatial/SA2_2021_BRIS_SHAPE","SA2_2021_BRIS")
DF <- st_drop_geometry(BRIS)[,1]





### ADAPTIVE CAPACITY: ----------------------------------------------------- ###
### ------------------------------------------------------------------------ ###
DATASET_A <- c("dAmbu","dBuss","dFire","dHosp","dPets","dPoli","dSesf","dShop")

DF_A <- DF
for (i in 1:length(DATASET_A)){
  new <- read.csv(paste0("../../data/processed_data/",DATASET_A[i],".csv"))[,-1]
  new[,2] <- frank(new[,2], na.last = "keep", ties.method = c("min"))/length(new[,2])
  DF_A <- merge(DF_A,new)
}























# ---------------------------------------------------------------------------- #